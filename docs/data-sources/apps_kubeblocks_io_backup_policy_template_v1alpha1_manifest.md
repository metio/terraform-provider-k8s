---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "k8s_apps_kubeblocks_io_backup_policy_template_v1alpha1_manifest Data Source - terraform-provider-k8s"
subcategory: "apps.kubeblocks.io"
description: |-
  BackupPolicyTemplate is the Schema for the BackupPolicyTemplates API (defined by provider)
---

# k8s_apps_kubeblocks_io_backup_policy_template_v1alpha1_manifest (Data Source)

BackupPolicyTemplate is the Schema for the BackupPolicyTemplates API (defined by provider)

## Example Usage

```terraform
data "k8s_apps_kubeblocks_io_backup_policy_template_v1alpha1_manifest" "example" {
  metadata = {
    name = "some-name"

  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `metadata` (Attributes) Data that helps uniquely identify this object. See https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#metadata for more details. (see [below for nested schema](#nestedatt--metadata))

### Optional

- `spec` (Attributes) Defines the desired state of the BackupPolicyTemplate. (see [below for nested schema](#nestedatt--spec))

### Read-Only

- `yaml` (String) The generated manifest in YAML format.

<a id="nestedatt--metadata"></a>
### Nested Schema for `metadata`

Required:

- `name` (String) Unique identifier for this object. See https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names for more details.

Optional:

- `annotations` (Map of String) Keys and values that can be used by external tooling to store and retrieve arbitrary metadata about this object. See https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/ for more details.
- `labels` (Map of String) Keys and values that can be used to organize and categorize objects. See https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/ for more details.


<a id="nestedatt--spec"></a>
### Nested Schema for `spec`

Required:

- `backup_policies` (Attributes List) Represents an array of backup policy templates for the specified ComponentDefinition. (see [below for nested schema](#nestedatt--spec--backup_policies))
- `cluster_definition_ref` (String) Specifies a reference to the ClusterDefinition name. This is an immutable attribute that cannot be changed after creation.

Optional:

- `identifier` (String) Acts as a unique identifier for this BackupPolicyTemplate. This identifier will be used as a suffix for the automatically generated backupPolicy name. It is required when multiple BackupPolicyTemplates exist to prevent backupPolicy override.

<a id="nestedatt--spec--backup_policies"></a>
### Nested Schema for `spec.backup_policies`

Required:

- `backup_methods` (Attributes List) Define the methods to be used for backups. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods))

Optional:

- `backoff_limit` (Number) Specifies the number of retries before marking the backup as failed.
- `component_def_ref` (String) References a componentDef defined in the ClusterDefinition spec. Must comply with the IANA Service Naming rule.
- `component_defs` (List of String) References to componentDefinitions. Must comply with the IANA Service Naming rule.
- `schedules` (Attributes List) Define the policy for backup scheduling. (see [below for nested schema](#nestedatt--spec--backup_policies--schedules))
- `target` (Attributes) The instance to be backed up. (see [below for nested schema](#nestedatt--spec--backup_policies--target))

<a id="nestedatt--spec--backup_policies--backup_methods"></a>
### Nested Schema for `spec.backup_policies.backup_methods`

Required:

- `name` (String) The name of backup method.

Optional:

- `action_set_name` (String) Refers to the ActionSet object that defines the backup actions. For volume snapshot backup, the actionSet is not required, the controller will use the CSI volume snapshotter to create the snapshot.
- `env` (Attributes List) Specifies the environment variables for the backup workload. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--env))
- `env_mapping` (Attributes List) Defines the mapping between the environment variables of the cluster and the keys of the environment values. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--env_mapping))
- `runtime_settings` (Attributes) Specifies runtime settings for the backup workload container. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--runtime_settings))
- `snapshot_volumes` (Boolean) Specifies whether to take snapshots of persistent volumes. If true, the ActionSetName is not required, the controller will use the CSI volume snapshotter to create the snapshot.
- `target` (Attributes) Specifies the target information to back up, it will override the target in backup policy. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target))
- `target_volumes` (Attributes) Specifies which volumes from the target should be mounted in the backup workload. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes))

<a id="nestedatt--spec--backup_policies--backup_methods--env"></a>
### Nested Schema for `spec.backup_policies.backup_methods.env`

Required:

- `name` (String) Name of the environment variable. Must be a C_IDENTIFIER.

Optional:

- `value` (String) Variable references $(VAR_NAME) are expanded using the previously defined environment variables in the container and any service environment variables. If a variable cannot be resolved, the reference in the input string will be unchanged. Double $$ are reduced to a single $, which allows for escaping the $(VAR_NAME) syntax: i.e. '$$(VAR_NAME)' will produce the string literal '$(VAR_NAME)'. Escaped references will never be expanded, regardless of whether the variable exists or not. Defaults to ''.
- `value_from` (Attributes) Source for the environment variable's value. Cannot be used if value is not empty. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from))

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from`

Optional:

- `config_map_key_ref` (Attributes) Selects a key of a ConfigMap. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--config_map_key_ref))
- `field_ref` (Attributes) Selects a field of the pod: supports metadata.name, metadata.namespace, 'metadata.labels['<KEY>']', 'metadata.annotations['<KEY>']', spec.nodeName, spec.serviceAccountName, status.hostIP, status.podIP, status.podIPs. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--field_ref))
- `resource_field_ref` (Attributes) Selects a resource of the container: only resources limits and requests (limits.cpu, limits.memory, limits.ephemeral-storage, requests.cpu, requests.memory and requests.ephemeral-storage) are currently supported. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--resource_field_ref))
- `secret_key_ref` (Attributes) Selects a key of a secret in the pod's namespace (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--secret_key_ref))

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--config_map_key_ref"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from.config_map_key_ref`

Required:

- `key` (String) The key to select.

Optional:

- `name` (String) Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?
- `optional` (Boolean) Specify whether the ConfigMap or its key must be defined


<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--field_ref"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from.field_ref`

Required:

- `field_path` (String) Path of the field to select in the specified API version.

Optional:

- `api_version` (String) Version of the schema the FieldPath is written in terms of, defaults to 'v1'.


<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--resource_field_ref"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from.resource_field_ref`

Required:

- `resource` (String) Required: resource to select

Optional:

- `container_name` (String) Container name: required for volumes, optional for env vars
- `divisor` (String) Specifies the output format of the exposed resources, defaults to '1'


<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--secret_key_ref"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from.secret_key_ref`

Required:

- `key` (String) The key of the secret to select from.  Must be a valid secret key.

Optional:

- `name` (String) Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?
- `optional` (Boolean) Specify whether the Secret or its key must be defined




<a id="nestedatt--spec--backup_policies--backup_methods--env_mapping"></a>
### Nested Schema for `spec.backup_policies.backup_methods.env_mapping`

Required:

- `key` (String) Specifies the environment variable key that requires mapping.
- `value_from` (Attributes) Defines the source from which the environment variable value is derived. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from))

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from`

Optional:

- `cluster_version_ref` (Attributes List) Maps to the environment value. This is an optional field. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--cluster_version_ref))
- `component_def` (Attributes List) Maps to the environment value. This is also an optional field. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--component_def))

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--cluster_version_ref"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from.cluster_version_ref`

Required:

- `mapping_value` (String) The value that corresponds to the specified ClusterVersion names.
- `names` (List of String) Represents an array of ClusterVersion names that can be mapped to an environment variable value.


<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--value_from--component_def"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.value_from.component_def`

Required:

- `mapping_value` (String) The value that corresponds to the specified ClusterVersion names.
- `names` (List of String) Represents an array of ClusterVersion names that can be mapped to an environment variable value.




<a id="nestedatt--spec--backup_policies--backup_methods--runtime_settings"></a>
### Nested Schema for `spec.backup_policies.backup_methods.runtime_settings`

Optional:

- `resources` (Attributes) Specifies the resource required by container. More info: https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/ (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--resources))

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--resources"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.resources`

Optional:

- `claims` (Attributes List) Claims lists the names of resources, defined in spec.resourceClaims, that are used by this container.  This is an alpha field and requires enabling the DynamicResourceAllocation feature gate.  This field is immutable. It can only be set for containers. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--resources--claims))
- `limits` (Map of String) Limits describes the maximum amount of compute resources allowed. More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
- `requests` (Map of String) Requests describes the minimum amount of compute resources required. If Requests is omitted for a container, it defaults to Limits if that is explicitly specified, otherwise to an implementation-defined value. Requests cannot exceed Limits. More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--resources--claims"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.resources.claims`

Required:

- `name` (String) Name must match the name of one entry in pod.spec.resourceClaims of the Pod where this field is used. It makes that resource available inside a container.




<a id="nestedatt--spec--backup_policies--backup_methods--target"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target`

Required:

- `role` (String) Specifies the instance of the corresponding role for backup. The roles can be:  - Leader, Follower, or Leaner for the Consensus component. - Primary or Secondary for the Replication component.  Invalid roles of the component will be ignored. For example, if the workload type is Replication and the component's replicas is 1, the secondary role is invalid. It will also be ignored when the component is Stateful or Stateless.  The role will be transformed into a role LabelSelector for the BackupPolicy's target attribute.

Optional:

- `account` (String) Refers to spec.componentDef.systemAccounts.accounts[*].name in the ClusterDefinition. The secret created by this account will be used to connect to the database. If not set, the secret created by spec.ConnectionCredential of the ClusterDefinition will be used.  It will be transformed into a secret for the BackupPolicy's target secret.
- `connection_credential` (Attributes) Specifies the connection credential to connect to the target database cluster. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--connection_credential))
- `connection_credential_key` (Attributes) Defines the connection credential key in the secret created by spec.ConnectionCredential of the ClusterDefinition. It will be ignored when the 'account' is set. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--connection_credential_key))
- `pod_selector` (Attributes) Used to find the target pod. The volumes of the target pod will be backed up. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--pod_selector))
- `resources` (Attributes) Specifies the kubernetes resources to back up. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--resources))
- `service_account_name` (String) Specifies the service account to run the backup workload.
- `strategy` (String) Specifies the PodSelectionStrategy to use when multiple pods are selected for the backup target. Valid values are:  - Any: Selects any one pod that matches the labelsSelector. - All: Selects all pods that match the labelsSelector.

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--connection_credential"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.connection_credential`

Required:

- `secret_name` (String) Refers to the Secret object that contains the connection credential.

Optional:

- `host_key` (String) Specifies the map key of the host in the connection credential secret.
- `password_key` (String) Specifies the map key of the password in the connection credential secret. This password will be saved in the backup annotation for full backup. You can use the environment variable DP_ENCRYPTION_KEY to specify encryption key.
- `port_key` (String) Specifies the map key of the port in the connection credential secret.
- `username_key` (String) Specifies the map key of the user in the connection credential secret.


<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--connection_credential_key"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.connection_credential_key`

Optional:

- `host_key` (String) Defines the map key of the host in the connection credential secret.
- `password_key` (String) Represents the key of the password in the ConnectionCredential secret. If not specified, the default key 'password' is used.
- `port_key` (String) Indicates the map key of the port in the connection credential secret.
- `username_key` (String) Represents the key of the username in the ConnectionCredential secret. If not specified, the default key 'username' is used.


<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--pod_selector"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.pod_selector`

Optional:

- `match_expressions` (Attributes List) matchExpressions is a list of label selector requirements. The requirements are ANDed. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--pod_selector--match_expressions))
- `match_labels` (Map of String) matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is 'key', the operator is 'In', and the values array contains only 'value'. The requirements are ANDed.
- `strategy` (String) Specifies the strategy to select the target pod when multiple pods are selected. Valid values are: Any: select any one pod that match the labelsSelector.  - 'Any': select any one pod that match the labelsSelector. - 'All': select all pods that match the labelsSelector.

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--pod_selector--match_expressions"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.pod_selector.match_expressions`

Required:

- `key` (String) key is the label key that the selector applies to.
- `operator` (String) operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist.

Optional:

- `values` (List of String) values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch.



<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--resources"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.resources`

Optional:

- `excluded` (List of String) excluded is a slice of namespaced-scoped resource type names to exclude in the kubernetes resources. The default value is empty.
- `included` (List of String) included is a slice of namespaced-scoped resource type names to include in the kubernetes resources. The default value is empty.
- `selector` (Attributes) A metav1.LabelSelector to filter the target kubernetes resources that need to be backed up. If not set, will do not back up any kubernetes resources. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--resources--selector))

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--resources--selector"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.resources.selector`

Optional:

- `match_expressions` (Attributes List) matchExpressions is a list of label selector requirements. The requirements are ANDed. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--resources--selector--match_expressions))
- `match_labels` (Map of String) matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is 'key', the operator is 'In', and the values array contains only 'value'. The requirements are ANDed.

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--resources--selector--match_expressions"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.resources.selector.match_expressions`

Required:

- `key` (String) key is the label key that the selector applies to.
- `operator` (String) operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist.

Optional:

- `values` (List of String) values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch.





<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes`

Optional:

- `volume_mounts` (Attributes List) Specifies the mount for the volumes specified in 'volumes' section. (see [below for nested schema](#nestedatt--spec--backup_policies--backup_methods--target_volumes--volume_mounts))
- `volumes` (List of String) Specifies the list of volumes of targeted application that should be mounted on the backup workload.

<a id="nestedatt--spec--backup_policies--backup_methods--target_volumes--volume_mounts"></a>
### Nested Schema for `spec.backup_policies.backup_methods.target_volumes.volume_mounts`

Required:

- `mount_path` (String) Path within the container at which the volume should be mounted.  Must not contain ':'.
- `name` (String) This must match the Name of a Volume.

Optional:

- `mount_propagation` (String) mountPropagation determines how mounts are propagated from the host to container and the other way around. When not set, MountPropagationNone is used. This field is beta in 1.10.
- `read_only` (Boolean) Mounted read-only if true, read-write otherwise (false or unspecified). Defaults to false.
- `sub_path` (String) Path within the volume from which the container's volume should be mounted. Defaults to '' (volume's root).
- `sub_path_expr` (String) Expanded path within the volume from which the container's volume should be mounted. Behaves similarly to SubPath but environment variable references $(VAR_NAME) are expanded using the container's environment. Defaults to '' (volume's root). SubPathExpr and SubPath are mutually exclusive.




<a id="nestedatt--spec--backup_policies--schedules"></a>
### Nested Schema for `spec.backup_policies.schedules`

Required:

- `backup_method` (String) Defines the backup method name that is defined in backupPolicy.
- `cron_expression` (String) Represents the cron expression for schedule, with the timezone set in UTC. Refer to https://en.wikipedia.org/wiki/Cron for more details.

Optional:

- `enabled` (Boolean) Specifies whether the backup schedule is enabled or not.
- `retention_period` (String) Determines the duration for which the backup should be retained. The controller will remove all backups that are older than the RetentionPeriod. For instance, a RetentionPeriod of '30d' will retain only the backups from the last 30 days. Sample duration format:  - years: 	2y - months: 	6mo - days: 		30d - hours: 	12h - minutes: 	30m  These durations can also be combined, for example: 30d12h30m.


<a id="nestedatt--spec--backup_policies--target"></a>
### Nested Schema for `spec.backup_policies.target`

Required:

- `role` (String) Specifies the instance of the corresponding role for backup. The roles can be:  - Leader, Follower, or Leaner for the Consensus component. - Primary or Secondary for the Replication component.  Invalid roles of the component will be ignored. For example, if the workload type is Replication and the component's replicas is 1, the secondary role is invalid. It will also be ignored when the component is Stateful or Stateless.  The role will be transformed into a role LabelSelector for the BackupPolicy's target attribute.

Optional:

- `account` (String) Refers to spec.componentDef.systemAccounts.accounts[*].name in the ClusterDefinition. The secret created by this account will be used to connect to the database. If not set, the secret created by spec.ConnectionCredential of the ClusterDefinition will be used.  It will be transformed into a secret for the BackupPolicy's target secret.
- `connection_credential_key` (Attributes) Defines the connection credential key in the secret created by spec.ConnectionCredential of the ClusterDefinition. It will be ignored when the 'account' is set. (see [below for nested schema](#nestedatt--spec--backup_policies--target--connection_credential_key))
- `strategy` (String) Specifies the PodSelectionStrategy to use when multiple pods are selected for the backup target. Valid values are:  - Any: Selects any one pod that matches the labelsSelector. - All: Selects all pods that match the labelsSelector.

<a id="nestedatt--spec--backup_policies--target--connection_credential_key"></a>
### Nested Schema for `spec.backup_policies.target.connection_credential_key`

Optional:

- `host_key` (String) Defines the map key of the host in the connection credential secret.
- `password_key` (String) Represents the key of the password in the ConnectionCredential secret. If not specified, the default key 'password' is used.
- `port_key` (String) Indicates the map key of the port in the connection credential secret.
- `username_key` (String) Represents the key of the username in the ConnectionCredential secret. If not specified, the default key 'username' is used.
