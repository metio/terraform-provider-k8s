---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "k8s_flux_framework_org_mini_cluster_v1alpha2_manifest Data Source - terraform-provider-k8s"
subcategory: "flux-framework.org"
description: |-
  MiniCluster is the Schema for a Flux job launcher on K8s
---

# k8s_flux_framework_org_mini_cluster_v1alpha2_manifest (Data Source)

MiniCluster is the Schema for a Flux job launcher on K8s

## Example Usage

```terraform
data "k8s_flux_framework_org_mini_cluster_v1alpha2_manifest" "example" {
  metadata = {
    name      = "some-name"
    namespace = "some-namespace"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `metadata` (Attributes) Data that helps uniquely identify this object. See https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#metadata for more details. (see [below for nested schema](#nestedatt--metadata))

### Optional

- `spec` (Attributes) MiniCluster is an HPC cluster in Kubernetes you can controlEither to submit a single job (and go away) or for a persistent single- or multi- user cluster (see [below for nested schema](#nestedatt--spec))

### Read-Only

- `yaml` (String) The generated manifest in YAML format.

<a id="nestedatt--metadata"></a>
### Nested Schema for `metadata`

Required:

- `name` (String) Unique identifier for this object. See https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names for more details.
- `namespace` (String) Namespaces provides a mechanism for isolating groups of resources within a single cluster. See https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/ for more details.

Optional:

- `annotations` (Map of String) Keys and values that can be used by external tooling to store and retrieve arbitrary metadata about this object. See https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/ for more details.
- `labels` (Map of String) Keys and values that can be used to organize and categorize objects. See https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/ for more details.


<a id="nestedatt--spec"></a>
### Nested Schema for `spec`

Required:

- `containers` (Attributes List) Containers is one or more containers to be created in a pod.There should only be one container to run flux with runFlux (see [below for nested schema](#nestedatt--spec--containers))

Optional:

- `archive` (Attributes) Archive to load or save (see [below for nested schema](#nestedatt--spec--archive))
- `cleanup` (Boolean) Cleanup the pods and storage when the index broker pod is complete
- `deadline_seconds` (Number) Should the job be limited to a particular number of seconds?Approximately one year. This cannot be zero or job won't start
- `flux` (Attributes) Flux options for the broker, shared across cluster (see [below for nested schema](#nestedatt--spec--flux))
- `interactive` (Boolean) Run a single-user, interactive minicluster
- `job_labels` (Map of String) Labels for the job
- `logging` (Attributes) Logging modes determine the output you see in the job log (see [below for nested schema](#nestedatt--spec--logging))
- `max_size` (Number) MaxSize (maximum number of pods to allow scaling to)
- `min_size` (Number) MinSize (minimum number of pods that must be up for Flux)Note that this option does not edit the number of tasks,so a job could run with fewer (and then not start)
- `network` (Attributes) A spec for exposing or defining the cluster headless service (see [below for nested schema](#nestedatt--spec--network))
- `pod` (Attributes) Pod spec details (see [below for nested schema](#nestedatt--spec--pod))
- `services` (Attributes List) Services are one or more service containers to bring upalongside the MiniCluster. (see [below for nested schema](#nestedatt--spec--services))
- `share_process_namespace` (Boolean) Share process namespace?
- `size` (Number) Size (number of job pods to run, size of minicluster in pods)This is also the minimum number required to start Flux
- `tasks` (Number) Total number of CPUs being run across entire cluster

<a id="nestedatt--spec--containers"></a>
### Nested Schema for `spec.containers`

Optional:

- `batch` (Boolean) Indicate that the command is a batch job that will be written to a file to submit
- `batch_raw` (Boolean) Don't wrap batch commands in flux submit (provide custom logic myself)
- `command` (String) Single user executable to provide to flux start
- `commands` (Attributes) More specific or detailed commands for just workers/broker (see [below for nested schema](#nestedatt--spec--containers--commands))
- `environment` (Map of String) Key/value pairs for the environment
- `image` (String) Container image must contain flux and flux-sched install
- `image_pull_secret` (String) Allow the user to pull authenticated imagesBy default no secret is selected. Settingthis with the name of an already existingimagePullSecret will specify that secretin the pod spec.
- `launcher` (Boolean) Indicate that the command is a launcher that willask for its own jobs (and provided directly to flux start)
- `life_cycle` (Attributes) Lifecycle can handle post start commands, etc. (see [below for nested schema](#nestedatt--spec--containers--life_cycle))
- `logs` (String) Log output directory
- `name` (String) Container name is only required for non flux runners
- `no_wrap_entrypoint` (Boolean) Do not wrap the entrypoint to wait for flux, add to path, etc?
- `ports` (List of String) Ports to be exposed to other containers in the clusterWe take a single list of integers and map to the same
- `pull_always` (Boolean) Allow the user to dictate pullingBy default we pull if not present. Settingthis to true will indicate to pull always
- `resources` (Attributes) Resources include limits and requests (see [below for nested schema](#nestedatt--spec--containers--resources))
- `run_flux` (Boolean) Application container intended to run flux (broker)
- `secrets` (Attributes) Secrets that will be added to the environmentThe user is expected to create their own secrets for the operator to find (see [below for nested schema](#nestedatt--spec--containers--secrets))
- `security_context` (Attributes) Security Contexthttps://kubernetes.io/docs/tasks/configure-pod-container/security-context/ (see [below for nested schema](#nestedatt--spec--containers--security_context))
- `volumes` (Attributes) Existing volumes that can be mounted (see [below for nested schema](#nestedatt--spec--containers--volumes))
- `working_dir` (String) Working directory to run command from

<a id="nestedatt--spec--containers--commands"></a>
### Nested Schema for `spec.containers.commands`

Optional:

- `broker_pre` (String) A single command for only the broker to run
- `init` (String) init command is run before anything
- `post` (String) post command is run in the entrypoint when the broker exits / finishes
- `pre` (String) pre command is run after global PreCommand, after asFlux is set (can override)
- `prefix` (String) Prefix to flux start / submit / brokerTypically used for a wrapper command to mount, etc.
- `script` (String) Custom script for submit (e.g., multiple lines)
- `service_pre` (String) A command only for service start.sh tor run
- `worker_pre` (String) A command only for workers to run


<a id="nestedatt--spec--containers--life_cycle"></a>
### Nested Schema for `spec.containers.life_cycle`

Optional:

- `post_start_exec` (String)
- `pre_stop_exec` (String)


<a id="nestedatt--spec--containers--resources"></a>
### Nested Schema for `spec.containers.resources`

Optional:

- `limits` (Map of String)
- `requests` (Map of String)


<a id="nestedatt--spec--containers--secrets"></a>
### Nested Schema for `spec.containers.secrets`

Required:

- `key` (String) Key under secretKeyRef->Key
- `name` (String) Name under secretKeyRef->Name


<a id="nestedatt--spec--containers--security_context"></a>
### Nested Schema for `spec.containers.security_context`

Optional:

- `add_capabilities` (List of String) Capabilities to add
- `privileged` (Boolean) Privileged container


<a id="nestedatt--spec--containers--volumes"></a>
### Nested Schema for `spec.containers.volumes`

Optional:

- `claim_name` (String) Claim name if the existing volume is a PVC
- `config_map_name` (String) Config map name if the existing volume is a config mapYou should also define items if you are using this
- `host_path` (String) An existing hostPath to bind to path
- `items` (Map of String) Items (key and paths) for the config map
- `path` (String) Path and claim name are always required if a secret isn't defined
- `read_only` (Boolean)
- `secret_name` (String) An existing secret



<a id="nestedatt--spec--archive"></a>
### Nested Schema for `spec.archive`

Optional:

- `path` (String) Save or load from this directory path


<a id="nestedatt--spec--flux"></a>
### Nested Schema for `spec.flux`

Optional:

- `arch` (String) Change the arch string - determines the binariesthat are downloaded to run the entrypoint
- `broker_config` (String) Optionally provide a manually created broker configthis is intended for bursting to remote clusters
- `bursting` (Attributes) Bursting - one or more external clusters to burst toWe assume a single, central MiniCluster with an ipaddressthat all connect to. (see [below for nested schema](#nestedatt--spec--flux--bursting))
- `complete_workers` (Boolean) Complete workers when they failThis is ideal if you don't want them to restart
- `connect_timeout` (String) Single user executable to provide to flux start
- `container` (Attributes) Container base for flux (see [below for nested schema](#nestedatt--spec--flux--container))
- `curve_cert` (String) Optionally provide an already existing curve certificateThis is not recommended in favor of providing the secretname as curveCertSecret, below
- `log_level` (Number) Log level to use for flux logging (only in non TestMode)
- `minimal_service` (Boolean) Only expose the broker service (to reduce load on DNS)
- `munge_secret` (String) Expect a secret (named according to this string)for a munge key. This is intended for bursting.Assumed to be at /etc/munge/munge.keyThis is binary data.
- `no_wait_socket` (Boolean) Do not wait for the socket
- `option_flags` (String) Flux option flags, usually provided with -ooptional - if needed, default option flags for the serverThese can also be set in the user interface to override here.This is only valid for a FluxRunner 'runFlux' true
- `scheduler` (Attributes) Custom attributes for the fluxion scheduler (see [below for nested schema](#nestedatt--spec--flux--scheduler))
- `submit_command` (String) Modify flux submit to be something else
- `wrap` (String) Commands for flux start --wrap

<a id="nestedatt--spec--flux--bursting"></a>
### Nested Schema for `spec.flux.bursting`

Optional:

- `clusters` (Attributes List) External clusters to burst to. Each externalcluster must share the same listing to align ranks (see [below for nested schema](#nestedatt--spec--flux--bursting--clusters))
- `hostlist` (String) Hostlist is a custom hostlist for the broker.tomlthat includes the local plus bursted cluster. Thisis typically used for bursting to another resourcetype, where we can predict the hostnames but theydon't follow the same convention as the Flux Operator
- `lead_broker` (Attributes) The lead broker ip address to join to. E.g., if we burstto cluster 2, this is the address to connect to cluster 1For the first cluster, this should not be defined (see [below for nested schema](#nestedatt--spec--flux--bursting--lead_broker))

<a id="nestedatt--spec--flux--bursting--clusters"></a>
### Nested Schema for `spec.flux.bursting.clusters`

Optional:

- `name` (String) The hostnames for the bursted clustersIf set, the user is responsible for ensuringuniqueness. The operator will set to burst-N
- `size` (Number) Size of bursted cluster.Defaults to same size as local minicluster if not set


<a id="nestedatt--spec--flux--bursting--lead_broker"></a>
### Nested Schema for `spec.flux.bursting.lead_broker`

Required:

- `address` (String) Lead broker address (ip or hostname)
- `name` (String) We need the name of the lead job to assemble the hostnames
- `size` (Number) Lead broker size

Optional:

- `port` (Number) Lead broker port - should only be used for external cluster



<a id="nestedatt--spec--flux--container"></a>
### Nested Schema for `spec.flux.container`

Optional:

- `disable` (Boolean) Disable the sidecar container, assuming that the main application container has flux
- `image` (String)
- `image_pull_secret` (String) Allow the user to pull authenticated imagesBy default no secret is selected. Settingthis with the name of an already existingimagePullSecret will specify that secretin the pod spec.
- `mount_path` (String) Mount path for flux to be at (will be added to path)
- `name` (String) Container name is only required for non flux runners
- `pull_always` (Boolean) Allow the user to dictate pullingBy default we pull if not present. Settingthis to true will indicate to pull always
- `python_path` (String) Customize python path for flux
- `resources` (Attributes) Resources include limits and requestsThese must be defined for cpu and memoryfor the QoS to be Guaranteed (see [below for nested schema](#nestedatt--spec--flux--container--resources))
- `working_dir` (String) Working directory to run command from

<a id="nestedatt--spec--flux--container--resources"></a>
### Nested Schema for `spec.flux.container.resources`

Optional:

- `limits` (Map of String)
- `requests` (Map of String)



<a id="nestedatt--spec--flux--scheduler"></a>
### Nested Schema for `spec.flux.scheduler`

Optional:

- `queue_policy` (String) Scheduler queue policy, defaults to 'fcfs' can also be 'easy'



<a id="nestedatt--spec--logging"></a>
### Nested Schema for `spec.logging`

Optional:

- `debug` (Boolean) Debug mode adds extra verbosity to Flux
- `quiet` (Boolean) Quiet mode silences all output so the job only shows the test running
- `strict` (Boolean) Strict mode ensures any failure will not continue in the job entrypoint
- `timed` (Boolean) Timed mode adds timing to Flux commands
- `zeromq` (Boolean) Enable Zeromq logging


<a id="nestedatt--spec--network"></a>
### Nested Schema for `spec.network`

Optional:

- `disable_affinity` (Boolean) Disable affinity rules that guarantee one network address / node
- `headless_name` (String) Name for cluster headless service


<a id="nestedatt--spec--pod"></a>
### Nested Schema for `spec.pod`

Optional:

- `annotations` (Map of String) Annotations for each pod
- `labels` (Map of String) Labels for each pod
- `node_selector` (Map of String) NodeSelectors for a pod
- `resources` (Map of String) Resources include limits and requests
- `scheduler_name` (String) Scheduler name for the pod
- `service_account_name` (String) Service account name for the pod


<a id="nestedatt--spec--services"></a>
### Nested Schema for `spec.services`

Optional:

- `batch` (Boolean) Indicate that the command is a batch job that will be written to a file to submit
- `batch_raw` (Boolean) Don't wrap batch commands in flux submit (provide custom logic myself)
- `command` (String) Single user executable to provide to flux start
- `commands` (Attributes) More specific or detailed commands for just workers/broker (see [below for nested schema](#nestedatt--spec--services--commands))
- `environment` (Map of String) Key/value pairs for the environment
- `image` (String) Container image must contain flux and flux-sched install
- `image_pull_secret` (String) Allow the user to pull authenticated imagesBy default no secret is selected. Settingthis with the name of an already existingimagePullSecret will specify that secretin the pod spec.
- `launcher` (Boolean) Indicate that the command is a launcher that willask for its own jobs (and provided directly to flux start)
- `life_cycle` (Attributes) Lifecycle can handle post start commands, etc. (see [below for nested schema](#nestedatt--spec--services--life_cycle))
- `logs` (String) Log output directory
- `name` (String) Container name is only required for non flux runners
- `no_wrap_entrypoint` (Boolean) Do not wrap the entrypoint to wait for flux, add to path, etc?
- `ports` (List of String) Ports to be exposed to other containers in the clusterWe take a single list of integers and map to the same
- `pull_always` (Boolean) Allow the user to dictate pullingBy default we pull if not present. Settingthis to true will indicate to pull always
- `resources` (Attributes) Resources include limits and requests (see [below for nested schema](#nestedatt--spec--services--resources))
- `run_flux` (Boolean) Application container intended to run flux (broker)
- `secrets` (Attributes) Secrets that will be added to the environmentThe user is expected to create their own secrets for the operator to find (see [below for nested schema](#nestedatt--spec--services--secrets))
- `security_context` (Attributes) Security Contexthttps://kubernetes.io/docs/tasks/configure-pod-container/security-context/ (see [below for nested schema](#nestedatt--spec--services--security_context))
- `volumes` (Attributes) Existing volumes that can be mounted (see [below for nested schema](#nestedatt--spec--services--volumes))
- `working_dir` (String) Working directory to run command from

<a id="nestedatt--spec--services--commands"></a>
### Nested Schema for `spec.services.commands`

Optional:

- `broker_pre` (String) A single command for only the broker to run
- `init` (String) init command is run before anything
- `post` (String) post command is run in the entrypoint when the broker exits / finishes
- `pre` (String) pre command is run after global PreCommand, after asFlux is set (can override)
- `prefix` (String) Prefix to flux start / submit / brokerTypically used for a wrapper command to mount, etc.
- `script` (String) Custom script for submit (e.g., multiple lines)
- `service_pre` (String) A command only for service start.sh tor run
- `worker_pre` (String) A command only for workers to run


<a id="nestedatt--spec--services--life_cycle"></a>
### Nested Schema for `spec.services.life_cycle`

Optional:

- `post_start_exec` (String)
- `pre_stop_exec` (String)


<a id="nestedatt--spec--services--resources"></a>
### Nested Schema for `spec.services.resources`

Optional:

- `limits` (Map of String)
- `requests` (Map of String)


<a id="nestedatt--spec--services--secrets"></a>
### Nested Schema for `spec.services.secrets`

Required:

- `key` (String) Key under secretKeyRef->Key
- `name` (String) Name under secretKeyRef->Name


<a id="nestedatt--spec--services--security_context"></a>
### Nested Schema for `spec.services.security_context`

Optional:

- `add_capabilities` (List of String) Capabilities to add
- `privileged` (Boolean) Privileged container


<a id="nestedatt--spec--services--volumes"></a>
### Nested Schema for `spec.services.volumes`

Optional:

- `claim_name` (String) Claim name if the existing volume is a PVC
- `config_map_name` (String) Config map name if the existing volume is a config mapYou should also define items if you are using this
- `host_path` (String) An existing hostPath to bind to path
- `items` (Map of String) Items (key and paths) for the config map
- `path` (String) Path and claim name are always required if a secret isn't defined
- `read_only` (Boolean)
- `secret_name` (String) An existing secret
